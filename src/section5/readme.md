# 스택 & 힙 메모리 영역
## 스택
- 스택 메모리는 각 스레드마다 독립적으로 존재한다.
- 메서드 호출 시 생성되는 정보는 스택 프레임에 저장된다.
  - 지역 변수, 매개변수, 반환주소, 연산 중간 결과 등이 저장된다.
- 스택은 후입선출 구조로 동작한다. 
- 메서드가 종료되면 해당 스택 프레임도 사라진다.

## 힙
- 힙 메모리는 JVM이 모든 스레드 간에 공유하는 공간이다.
  - new 키워드로 생성되는 객체(instance)(컬렉션 포함), 클래스 멤버(instance fields), static 변수 등이 저장된다.
    - static의 경우 클래스 수준의 변수이기 때문에 메서드 안(지역 변수 영역)에는 선언할 수 없다.

## Object vs References
```java
void myMethod() {
  Object ref1 = new Object();
  Object ref2 = ref1;
}
```
- `new Object()` : 객체 자체는 항상 힙에 저장된다.
- `ref1`, `ref2`는 레퍼런스 변수이다.
  - 둘은 같은 힙 객체를 가리킨다.
  - 만약 이 둘이 메서드 안에 선언되면 지역 변수로 스택에 저장된다.
  - 만약 이 둘이 클래스의 멤버라면 힙에 저장된다.

# 스레드 간 리소스 공유
- 리소스란 컴퓨터 프로그램 안의 어떤 데이터나 상태를 나타낸다.
- 리소스의 종류
  - 변수
    - `static` 변수
      - 모든 스레드가 접근 가능하다.
    - `instance` 변수 
      - 객체를 공유하면 변수도 공유된다.
  - 데이터 구조
    - 배열, 컬렉션, 맵 등
  - 파일
  - 메시지 큐
  - 모든 객체
    - ex) 데이터베이스나 네트워크 연결을 포함한 객체

## 왜 스레드 간 리소스 공유가 필요한가?
- 공통 데이터에 대한 접근이 필요하다.
  - 여러 스레드가 같은 데이터를 처리해야하는 경우가 있다.
  - 예를 들어 서버에서 여러 요청을 처리하는 스레드들이 공통 캐시나 DB 커넥션 풀을 사용하는 경우이다.
- 메모리를 절약할 수 있다.
  - 스레드들은 같은 프로세스의 메모리 공간을 공유하기 때문에 공유된 자원을 사용하면 메모리를 절약할 수 있다.
- 속도 향상
  - 리소스를 공유함으로써 작업 중복을 줄일 수 있다.
    - 필요한 데이터를 새로 생성하지 않고 재사용 할 수 있어 전체 처리 속도가 향상된다.